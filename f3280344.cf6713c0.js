(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{89:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return c})),t.d(n,"rightToc",(function(){return i})),t.d(n,"default",(function(){return u}));var r=t(2),a=t(6),s=(t(0),t(94)),o={title:"Insecure Randomness",sidebar_label:"Insecure Randomness"},c={unversionedId:"security_awareness/languages/Csharp/insecure_randomness",id:"security_awareness/languages/Csharp/insecure_randomness",isDocsHomePage:!1,title:"Insecure Randomness",description:"Introduction",source:"@site/docs/security_awareness/languages/Csharp/insecure_randomness.md",slug:"/security_awareness/languages/Csharp/insecure_randomness",permalink:"/glasswall-it-infosec-site/docs/security_awareness/languages/Csharp/insecure_randomness",version:"current",sidebar_label:"Insecure Randomness",sidebar:"someSidebar",previous:{title:"Hard-coded Keys",permalink:"/glasswall-it-infosec-site/docs/security_awareness/languages/Csharp/hardcoded_keys"},next:{title:"Open Redirect",permalink:"/glasswall-it-infosec-site/docs/security_awareness/languages/Csharp/open_redirect"}},i=[],l={rightToc:i};function u(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(s.b)("wrapper",Object(r.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Introduction")),Object(s.b)("p",null,"Using a cryptographically weak pseudo-random number generator may allow an attacker to predict what security-sensitive value will be generated.",Object(s.b)("br",null),"Insecure randomness errors occur when a function that can produce predictable values is used as a source of randomness in security-sensitive context."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Example1 of a vulnerable code")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-c"}),"using System;\n\nclass ExampleClass\n{\n    public void ExampleMethod(Random random)\n    {\n        var sensitiveVariable = random.Next();\n    }\n}\n")),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Example2 of a vulnerable code")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-c"}),"\nvar random = new Random(); // Sensitive use of Random\nbyte[] data = new byte[16];\nrandom.NextBytes(data);\nreturn BitConverter.ToString(data); // Check if this value is used for hashing or encryption\n\n")),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Remediation")),Object(s.b)("p",null,"Avoid or fix violations by following the following practices:"),Object(s.b)("ul",null,Object(s.b)("li",null,"use a cryptographically strong random number generator."),Object(s.b)("li",null,"Only use random number generators which are recommended by OWASP or any other trusted organization. "),Object(s.b)("li",null,"Use the generated random values only once."),Object(s.b)("li",null,"Don't expose the generated random value. If you have to store it, make sure that the database or file is secure.")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-c"}),"using System;\nusing System.Security.Cryptography;\n\nclass ExampleClass\n{\n    public void ExampleMethod(RandomNumberGenerator randomNumberGenerator, int toExclusive)\n    {\n        var sensitiveVariable = randomNumberGenerator.GetInt32(toExclusive);\n    }\n}\n")),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Risk")),Object(s.b)("ul",null,Object(s.b)("li",null,"An attacker might be able to guess an ID for a resource that is owned by another user."),Object(s.b)("li",null,"An attacker may access the restricted functionality by guessing the ID or key."),Object(s.b)("li",null,"provide attackers with sensitive information or even execute arbitrary code")),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"References ")),Object(s.b)("p",null,Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca5394"}),"https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca5394")),Object(s.b)("p",null,Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"https://rules.sonarsource.com/csharp/RSPEC-2245"}),"https://rules.sonarsource.com/csharp/RSPEC-2245")),Object(s.b)("p",null,Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"https://owasp.org/www-community/vulnerabilities/Insecure_Randomness"}),"https://owasp.org/www-community/vulnerabilities/Insecure_Randomness")))}u.isMDXComponent=!0},94:function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return m}));var r=t(0),a=t.n(r);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=a.a.createContext({}),u=function(e){var n=a.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},b=function(e){var n=u(e.components);return a.a.createElement(l.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},d=a.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,o=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),b=u(t),d=r,m=b["".concat(o,".").concat(d)]||b[d]||p[d]||s;return t?a.a.createElement(m,c(c({ref:n},l),{},{components:t})):a.a.createElement(m,c({ref:n},l))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=t.length,o=new Array(s);o[0]=d;var c={};for(var i in n)hasOwnProperty.call(n,i)&&(c[i]=n[i]);c.originalType=e,c.mdxType="string"==typeof e?e:r,o[1]=c;for(var l=2;l<s;l++)o[l]=t[l];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"}}]);